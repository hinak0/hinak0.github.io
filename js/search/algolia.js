window.addEventListener("load",()=>{const{algolia:t}=GLOBAL_CONFIG;const{appId:e,apiKey:i,indexName:n,hitsPerPage:a=5,languages:s}=t;if(!e||!i||!n){return console.error("Algolia setting is invalid!")}const l=document.getElementById("search-mask");const o=document.querySelector("#algolia-search .search-dialog");const r=t=>{const e=t?"animateIn":"animateOut";const i=t?"to_show 0.5s":"to_hide 0.5s";const n=t?"titleScale 0.5s":"search_close .5s";btf[e](l,i);btf[e](o,n)};const c=()=>{if(window.innerWidth<768){o.style.setProperty("--search-height",`${window.innerHeight}px`)}};const g=()=>{btf.overflowPaddingR.add();r(true);P(false);setTimeout(()=>{const t=document.querySelector("#algolia-search-input .ais-SearchBox-input");if(t)t.focus()},100);const t=e=>{if(e.code==="Escape"){d();document.removeEventListener("keydown",t)}};document.addEventListener("keydown",t);c();window.addEventListener("resize",c)};const d=()=>{btf.overflowPaddingR.remove();r(false);window.removeEventListener("resize",c)};const f=()=>{btf.addEventListenerPjax(document.querySelector("#search-button > .search"),"click",g)};const p=()=>{l.addEventListener("click",d);document.querySelector("#algolia-search .search-close-button").addEventListener("click",d)};const u=t=>{if(!t)return"";let e="";if(typeof t==="string"){e=t.trim()}else if(typeof t==="object"){if(t.value!==undefined){e=String(t.value).trim();if(!e)return""}else if(t.matchedWords||t.matchLevel||t.fullyHighlighted!==undefined){return""}else{try{e=JSON.stringify(t).trim();if(e==="{}"||e==="[]"||e==='""'){return""}}catch(t){return""}}}else if(t.toString&&typeof t.toString==="function"){e=t.toString().trim();if(e==="[object Object]"||e==="[object Array]"){return""}}else{return""}const i=e.indexOf("<mark>");let n=i-30;let a=i+120;let s="";let l="";if(n<=0){n=0;a=140}else{s="..."}if(a>e.length){a=e.length}else{l="..."}let o=e.substring(n,a);const r=o.indexOf(">");const c=o.indexOf("<");if(r!==-1&&(c===-1||r<c)){o=o.substring(r+1)}const g=o.lastIndexOf("<");const d=o.lastIndexOf(">");if(g!==-1&&g>d){o=o.substring(0,g)}const f=[];let p="";let u=0;while(u<o.length){if(o[u]==="<"){if(o[u+1]==="/"){const t=o.indexOf(">",u);if(t!==-1){const e=o.substring(u+2,t);for(let t=f.length-1;t>=0;t--){if(f[t]===e){f.splice(t,1);break}}p+=o.substring(u,t+1);u=t+1;continue}}else if(o.substr(u,2)==="<!"||o.indexOf("/>",u)!==-1&&o.indexOf("/>",u)<o.indexOf(">",u)){const t=o.indexOf(">",u);if(t!==-1){p+=o.substring(u,t+1);u=t+1;continue}}else{const t=o.indexOf(">",u);if(t!==-1){const e=o.substring(u+1,o.indexOf(" ",u)>-1&&o.indexOf(" ",u)<t?o.indexOf(" ",u):t).split(/\s/)[0];f.push(e);p+=o.substring(u,t+1);u=t+1;continue}}}p+=o[u];u++}while(f.length>0){const t=f.pop();p+=`</${t}>`}if(n>0||s){const t=e.indexOf("<",n>0?n-30:0);const i=e.indexOf("<mark>",n>0?n-30:0);if(t!==-1&&(i===-1||t<i)){s="..."}}o=p;return`${s}${o}${l}`};const h=t=>{if(!t)return"";if(typeof t==="string"){return t.trim()}if(typeof t==="object"&&t.value!==undefined){return String(t.value).trim()}return""};let m;if(window["algoliasearch/lite"]&&typeof window["algoliasearch/lite"].liteClient==="function"){m=window["algoliasearch/lite"].liteClient(e,i)}else if(typeof window.algoliasearch==="function"){m=window.algoliasearch(e,i)}else{return console.error("Algolia search client not found!")}if(!m){return console.error("Failed to initialize Algolia search client")}let y="";const P=t=>{const e=document.getElementById("loading-status");if(e){e.hidden=!t}};const b={get searchInput(){return document.querySelector("#algolia-search-input .ais-SearchBox-input")},get hits(){return document.getElementById("algolia-hits")},get hitsEmpty(){return document.getElementById("algolia-hits-empty")},get hitsList(){return document.querySelector("#algolia-hits .ais-Hits-list")},get hitsWrapper(){return document.querySelector("#algolia-hits .ais-Hits")},get pagination(){return document.getElementById("algolia-pagination")},get paginationList(){return document.querySelector("#algolia-pagination .ais-Pagination-list")},get stats(){return document.querySelector("#algolia-info .ais-Stats-text")}};const w=t=>{b.pagination.style.display=t?"":"none";b.stats.style.display=t?"":"none"};const v=(t,e,i=0)=>{if(t.length===0&&e){b.hitsEmpty.textContent=s.hits_empty.replace(/\$\{query}/,e);b.hitsEmpty.style.display="";b.hitsWrapper.style.display="none";b.stats.style.display="none";return}b.hitsEmpty.style.display="none";const n=t.map((t,e)=>{const n=i*a+e+1;const s=t.permalink||GLOBAL_CONFIG.root+t.path;const l=t._highlightResult||t;let o="";try{if(l.contentStripTruncate){o=u(l.contentStripTruncate)}else if(l.contentStrip){o=u(l.contentStrip)}else if(l.content){o=u(l.content)}else if(t.contentStripTruncate){o=u(t.contentStripTruncate)}else if(t.contentStrip){o=u(t.contentStrip)}else if(t.content){o=u(t.content)}}catch(t){o=""}let r="no-title";try{if(l.title){r=h(l.title)||"no-title"}else if(t.title){r=h(t.title)||"no-title"}if(!r||r==="no-title"){if(typeof t.title==="string"&&t.title.trim()){r=t.title.trim()}else if(t.title&&typeof t.title==="object"&&t.title.value){r=String(t.title.value).trim()||"no-title"}else{r="no-title"}}}catch(t){r="no-title"}return`\n        <li class="ais-Hits-item" value="${n}">\n          <a href="${s}" class="algolia-hit-item-link">\n            <span class="algolia-hits-item-title">${r}</span>\n            ${o?`<div class="algolia-hit-item-content">${o}</div>`:""}\n          </a>\n        </li>`}).join("");b.hitsList.innerHTML=n;b.hitsWrapper.style.display=e?"":"none";if(t.length>0){b.stats.style.display=""}};const x=(t,e)=>{if(e<=1){b.pagination.style.display="none";b.paginationList.innerHTML="";return}b.pagination.style.display="block";const i=t===0;const n=t===e-1;const a=window.innerWidth<768;const s=a?3:5;let l=Math.max(0,t-Math.floor(s/2));const o=Math.min(e-1,l+s-1);if(o-l+1<s){l=Math.max(0,o-s+1)}let r="";if(e>s&&l>0){r+=`\n        <li class="ais-Pagination-item ais-Pagination-item--page">\n          <a class="ais-Pagination-link" aria-label="Page 1" href="#" data-page="0">1</a>\n        </li>`;if(l>1){r+=`\n          <li class="ais-Pagination-item ais-Pagination-item--ellipsis">\n            <span class="ais-Pagination-link">...</span>\n          </li>`}}for(let e=l;e<=o;e++){const i=e===t;if(i){r+=`\n          <li class="ais-Pagination-item ais-Pagination-item--page ais-Pagination-item--selected">\n            <span class="ais-Pagination-link" aria-label="Page ${e+1}">${e+1}</span>\n          </li>`}else{r+=`\n          <li class="ais-Pagination-item ais-Pagination-item--page">\n            <a class="ais-Pagination-link" aria-label="Page ${e+1}" href="#" data-page="${e}">${e+1}</a>\n          </li>`}}if(e>s&&o<e-1){if(o<e-2){r+=`\n          <li class="ais-Pagination-item ais-Pagination-item--ellipsis">\n            <span class="ais-Pagination-link">...</span>\n          </li>`}r+=`\n        <li class="ais-Pagination-item ais-Pagination-item--page">\n          <a class="ais-Pagination-link" aria-label="Page ${e}" href="#" data-page="${e-1}">${e}</a>\n        </li>`}if(e>1){b.paginationList.innerHTML=`\n            <li class="ais-Pagination-item ais-Pagination-item--previousPage ${i?"ais-Pagination-item--disabled":""}">\n              ${i?'<span class="ais-Pagination-link ais-Pagination-link--disabled" aria-label="Previous Page"><i class="fas fa-angle-left"></i></span>':`<a class="ais-Pagination-link" aria-label="Previous Page" href="#" data-page="${t-1}"><i class="fas fa-angle-left"></i></a>`}\n            </li>\n            ${r}\n            <li class="ais-Pagination-item ais-Pagination-item--nextPage ${n?"ais-Pagination-item--disabled":""}">\n              ${n?'<span class="ais-Pagination-link ais-Pagination-link--disabled" aria-label="Next Page"><i class="fas fa-angle-right"></i></span>':`<a class="ais-Pagination-link" aria-label="Next Page" href="#" data-page="${t+1}"><i class="fas fa-angle-right"></i></a>`}\n            </li>`;b.pagination.style.display=y?"":"none"}else{b.pagination.style.display="none"}};const S=(t,e,i)=>{if(i){const i=s.hits_stats.replace(/\$\{hits}/,t).replace(/\$\{time}/,e);b.stats.innerHTML=`<hr>${i}`;b.stats.style.display=""}else{b.stats.style.display="none"}};const k=async(t,e=0)=>{if(!t.trim()){y="";v([],"",0);x(0,0);S(0,0,"");w(false);return}P(true);y=t;try{let i;if(m&&typeof m.search==="function"){const s=await m.search([{indexName:n,query:t,params:{page:e,hitsPerPage:a,highlightPreTag:"<mark>",highlightPostTag:"</mark>",attributesToHighlight:["title","content","contentStrip","contentStripTruncate"]}}]);i=s.results[0]}else if(m&&typeof m.initIndex==="function"){const s=m.initIndex(n);i=await s.search(t,{page:e,hitsPerPage:a,highlightPreTag:"<mark>",highlightPostTag:"</mark>",attributesToHighlight:["title","content","contentStrip","contentStripTruncate"]})}else{throw new Error("Algolia: No compatible search method available")}v(i.hits||[],t,e);const s=i.nbHits<=a?1:i.nbPages||0;x(e,s);S(i.nbHits||0,i.processingTimeMS||0,t);const l=i.hits&&i.hits.length>0;w(l);if(window.pjax){window.pjax.refresh(document.getElementById("algolia-hits"))}}catch(i){console.error("Algolia search error:",i);v([],t,e);x(0,0);S(0,0,t)}finally{P(false)}};let $;const L=(t,e=300)=>{clearTimeout($);$=setTimeout(()=>k(t),e)};const E=()=>{P(false);if(b.searchInput){b.searchInput.addEventListener("input",t=>{const e=t.target.value;L(e)})}const t=document.querySelector("#algolia-search-input .ais-SearchBox-form");if(t){t.addEventListener("submit",t=>{t.preventDefault();const e=b.searchInput.value;k(e)})}b.pagination.addEventListener("click",t=>{t.preventDefault();const e=t.target.closest("a[data-page]");if(e){const t=parseInt(e.dataset.page,10);if(!isNaN(t)&&y){k(y,t)}}});w(false)};E();f();p();window.addEventListener("pjax:complete",()=>{if(!btf.isHidden(l))d();f()})});